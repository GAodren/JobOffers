<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Offers - Aodren</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }

        /* Header */
        .header {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats {
            display: flex;
            gap: 1.5rem;
        }

        .stat {
            text-align: center;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #6366f1;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Filters */
        .filters-section {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            background: rgba(30, 41, 59, 0.5);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            flex: 1;
            min-width: 180px;
        }

        .filter-label {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filter-select, .filter-input {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-select:hover, .filter-input:hover {
            border-color: #6366f1;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        /* Main Content */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem 2rem;
        }

        /* Jobs Grid */
        .jobs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        /* Job Card */
        .job-card {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .job-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #6366f1, #a855f7);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .job-card:hover {
            transform: translateY(-4px);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .job-card:hover::before {
            opacity: 1;
        }

        .job-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .job-score {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .score-high {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .score-medium {
            background: rgba(249, 115, 22, 0.2);
            color: #f97316;
            border: 1px solid rgba(249, 115, 22, 0.3);
        }

        .score-low {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .job-status {
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-new {
            background: rgba(99, 102, 241, 0.2);
            color: #818cf8;
        }

        .status-applied {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .status-interview {
            background: rgba(249, 115, 22, 0.2);
            color: #f97316;
        }

        .status-accepted {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .job-title {
            font-size: 1.15rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .job-company {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #a855f7;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        .job-location {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #94a3b8;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .job-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .job-tag {
            background: rgba(99, 102, 241, 0.15);
            color: #a5b4fc;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .job-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .job-salary {
            color: #22c55e;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .job-date {
            color: #64748b;
            font-size: 0.8rem;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            padding: 2rem;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: #1e293b;
            border-radius: 20px;
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            background: #1e293b;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #94a3b8;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.25rem;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-section {
            margin-bottom: 1.5rem;
        }

        .modal-section-title {
            font-size: 0.8rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .modal-section-content {
            color: #cbd5e1;
            line-height: 1.6;
        }

        .modal-points {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .point-positive, .point-negative {
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .point-positive {
            background: rgba(34, 197, 94, 0.1);
            border-left: 3px solid #22c55e;
            color: #86efac;
        }

        .point-negative {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid #ef4444;
            color: #fca5a5;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .status-selector {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .status-btn {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .status-btn.active {
            border-color: currentColor;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .empty-state-title {
            font-size: 1.25rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .stats {
                width: 100%;
                justify-content: center;
            }

            .jobs-grid {
                grid-template-columns: 1fr;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.7);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üíº</div>
                <h1>Job Offers</h1>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalJobs">0</div>
                    <div class="stat-label">Offres</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="appliedJobs">0</div>
                    <div class="stat-label">Postul√©</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="avgScore">0</div>
                    <div class="stat-label">Score Moy.</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Filters -->
    <section class="filters-section">
        <div class="filters">
            <div class="filter-group">
                <label class="filter-label">Rechercher</label>
                <input type="text" class="filter-input" id="searchFilter" placeholder="Titre, entreprise...">
            </div>
            <div class="filter-group">
                <label class="filter-label">Ville</label>
                <select class="filter-select" id="locationFilter">
                    <option value="">Toutes les villes</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Score minimum</label>
                <select class="filter-select" id="scoreFilter">
                    <option value="0">Tous les scores</option>
                    <option value="7">7+</option>
                    <option value="8">8+</option>
                    <option value="9">9+</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Statut</label>
                <select class="filter-select" id="statusFilter">
                    <option value="">Tous les statuts</option>
                    <option value="new">√Ä voir</option>
                    <option value="applied">Postul√©</option>
                    <option value="interview">Entretien</option>
                    <option value="accepted">Accept√©</option>
                    <option value="rejected">Refus√©</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main">
        <div class="jobs-grid" id="jobsGrid">
            <!-- Jobs will be inserted here -->
        </div>
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-state-icon">üîç</div>
            <div class="empty-state-title">Aucune offre trouv√©e</div>
            <p>Essayez de modifier vos filtres</p>
        </div>
    </main>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <div>
                    <h2 class="job-title" id="modalTitle"></h2>
                    <div class="job-company" id="modalCompany"></div>
                    <div class="job-location" id="modalLocation"></div>
                </div>
                <button class="modal-close" id="modalClose">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <div class="modal-section-title">Statut de candidature</div>
                    <div class="status-selector" id="statusSelector">
                        <button class="status-btn status-new" data-status="new">√Ä voir</button>
                        <button class="status-btn status-applied" data-status="applied">Postul√©</button>
                        <button class="status-btn status-interview" data-status="interview">Entretien</button>
                        <button class="status-btn status-accepted" data-status="accepted">Accept√©</button>
                        <button class="status-btn status-rejected" data-status="rejected">Refus√©</button>
                    </div>
                </div>
                <div class="modal-section">
                    <div class="modal-section-title">Informations</div>
                    <div class="modal-section-content">
                        <p><strong>Type de contrat:</strong> <span id="modalContract"></span></p>
                        <p><strong>Exp√©rience:</strong> <span id="modalExperience"></span></p>
                        <p><strong>Salaire:</strong> <span id="modalSalary"></span></p>
                        <p><strong>Stack:</strong> <span id="modalStack"></span></p>
                    </div>
                </div>
                <div class="modal-section">
                    <div class="modal-section-title">Points positifs</div>
                    <div class="modal-points" id="modalPositives"></div>
                </div>
                <div class="modal-section">
                    <div class="modal-section-title">Points n√©gatifs</div>
                    <div class="modal-points" id="modalNegatives"></div>
                </div>
                <div class="modal-section">
                    <div class="modal-section-title">Commentaire</div>
                    <div class="modal-section-content" id="modalComment"></div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#" class="btn btn-primary" id="modalApplyBtn" target="_blank">
                    üöÄ Postuler
                </a>
                <a href="#" class="btn btn-secondary" id="modalCompanyBtn" target="_blank">
                    üè¢ Voir l'entreprise
                </a>
            </div>
        </div>
    </div>

    <script>
        // Donn√©es de test (sera remplac√© par jobs.json)
        const testJobs = [
            {
                id: "1",
                titre: "Full Stack Engineer (Business Automation)",
                entreprise: "Crypto.com",
                entreprise_url: "https://sg.linkedin.com/company/cryptocom",
                localisation: "Hong Kong",
                type_contrat: "Full-time",
                type_travail: "Engineering and Information Technology",
                stack: "JavaScript, React, Node.js, Elixir, Ruby, PostgreSQL",
                salaire: "Non pr√©cis√©",
                experience_requise: "Mid-Senior level",
                score: 8,
                points_positifs: ["Grande entreprise crypto reconnue", "Stack moderne", "Localisation Hong Kong"],
                points_negatifs: ["Niveau d'exp√©rience √©lev√© demand√©"],
                commentaire: "Excellente opportunit√© dans une entreprise crypto majeure, mais le niveau d'exp√©rience requis est √©lev√©.",
                lien: "https://hk.linkedin.com/jobs/view/full-stack-engineer-business-automation-at-crypto-com-4308721313",
                date_publication: "2025-12-09",
                nb_candidats: "25"
            },
            {
                id: "2",
                titre: "Shopify Frontend Developer",
                entreprise: "Apex",
                entreprise_url: "https://www.linkedin.com/company/apex-cro",
                localisation: "Hong Kong SAR",
                type_contrat: "Full-time",
                type_travail: "Information Technology",
                stack: "HTML, CSS, JavaScript, Shopify Liquid, WordPress, Webflow",
                salaire: "$1,500 - $2,500/mois",
                experience_requise: "Associate (0-3 ans)",
                score: 9,
                points_positifs: ["Niveau junior accept√©", "100% remote", "Stack web classique", "Salaire indiqu√©"],
                points_negatifs: ["Salaire relativement bas"],
                commentaire: "Tr√®s bonne opportunit√© pour un d√©veloppeur junior, remote et stack accessible.",
                lien: "https://hk.linkedin.com/jobs/view/shopify-frontend-developer-at-apex-4349136830",
                date_publication: "2025-12-10",
                nb_candidats: "25"
            },
            {
                id: "3",
                titre: "Backend Software Engineer",
                entreprise: "Epiq",
                entreprise_url: "https://www.linkedin.com/company/epiqglobal",
                localisation: "Hong Kong",
                type_contrat: "Full-time",
                type_travail: "Engineering and Information Technology",
                stack: "Python, PostgreSQL, Docker, Kubernetes, GitHub Actions",
                salaire: "Non pr√©cis√©",
                experience_requise: "Entry level",
                score: 9,
                points_positifs: ["Entry level", "Stack Python int√©ressante", "Entreprise AI/Legal tech", "Hong Kong"],
                points_negatifs: [],
                commentaire: "Excellente offre entry level avec une stack moderne et un domaine innovant.",
                lien: "https://hk.linkedin.com/jobs/view/backend-software-engineer-at-epiq-4319267383",
                date_publication: "2025-12-09",
                nb_candidats: "117"
            },
            {
                id: "4",
                titre: "Full Stack Engineer",
                entreprise: "Blacksquare Ltd",
                entreprise_url: "https://hk.linkedin.com/company/blacksquare-ltd",
                localisation: "Hong Kong",
                type_contrat: "Full-time",
                type_travail: "Financial Services",
                stack: "Next.js, React, TypeScript, MongoDB",
                salaire: "Non pr√©cis√©",
                experience_requise: "Mid-Senior level (5+ ans)",
                score: 7,
                points_positifs: ["Stack tr√®s moderne", "Asset Management", "Greenfield projects"],
                points_negatifs: ["5+ ans d'exp√©rience requis"],
                commentaire: "Stack attractive mais niveau d'exp√©rience trop √©lev√©.",
                lien: "https://hk.linkedin.com/jobs/view/full-stack-engineer-at-blacksquare-ltd-4326590977",
                date_publication: "2025-12-10",
                nb_candidats: "41"
            },
            {
                id: "5",
                titre: "Software Engineer",
                entreprise: "Revolut",
                entreprise_url: "https://www.linkedin.com/company/revolut",
                localisation: "London, UK",
                type_contrat: "Full-time",
                type_travail: "FinTech",
                stack: "Java, Kotlin, Spring Boot, PostgreSQL, AWS",
                salaire: "¬£45,000 - ¬£60,000/an",
                experience_requise: "1-3 ans",
                score: 9,
                points_positifs: ["Fintech leader", "Londres", "Salaire comp√©titif", "Niveau accessible"],
                points_negatifs: ["Stack Java (√† apprendre)"],
                commentaire: "Excellente opportunit√© chez une licorne fintech √† Londres.",
                lien: "https://www.revolut.com/careers",
                date_publication: "2025-12-08",
                nb_candidats: "200+"
            }
        ];

        // State
        let jobs = [];
        let jobStatuses = {};

        // Load statuses from localStorage
        function loadStatuses() {
            const saved = localStorage.getItem('jobStatuses');
            if (saved) {
                jobStatuses = JSON.parse(saved);
            }
        }

        // Save statuses to localStorage
        function saveStatuses() {
            localStorage.setItem('jobStatuses', JSON.stringify(jobStatuses));
        }

        // Get job status
        function getJobStatus(jobId) {
            return jobStatuses[jobId] || 'new';
        }

        // Set job status
        function setJobStatus(jobId, status) {
            jobStatuses[jobId] = status;
            saveStatuses();
            renderJobs();
            updateStats();
        }

        // Get score class
        function getScoreClass(score) {
            if (score >= 8) return 'score-high';
            if (score >= 5) return 'score-medium';
            return 'score-low';
        }

        // Get status class
        function getStatusClass(status) {
            return `status-${status}`;
        }

        // Get status label
        function getStatusLabel(status) {
            const labels = {
                'new': '√Ä voir',
                'applied': 'Postul√©',
                'interview': 'Entretien',
                'accepted': 'Accept√©',
                'rejected': 'Refus√©'
            };
            return labels[status] || '√Ä voir';
        }

        // Format date
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' });
        }

        // Render job card
        function renderJobCard(job) {
            const status = getJobStatus(job.id);
            const stackTags = job.stack.split(',').slice(0, 3).map(s => 
                `<span class="job-tag">${s.trim()}</span>`
            ).join('');

            return `
                <div class="job-card" data-job-id="${job.id}">
                    <div class="job-card-header">
                        <div class="job-score ${getScoreClass(job.score)}">${job.score}</div>
                        <span class="job-status ${getStatusClass(status)}">${getStatusLabel(status)}</span>
                    </div>
                    <h3 class="job-title">${job.titre}</h3>
                    <div class="job-company">üè¢ ${job.entreprise}</div>
                    <div class="job-location">üìç ${job.localisation}</div>
                    <div class="job-tags">${stackTags}</div>
                    <div class="job-footer">
                        <span class="job-salary">${job.salaire !== 'Non pr√©cis√©' ? 'üí∞ ' + job.salaire : ''}</span>
                        <span class="job-date">${formatDate(job.date_publication)}</span>
                    </div>
                </div>
            `;
        }

        // Get filtered jobs
        function getFilteredJobs() {
            const search = document.getElementById('searchFilter').value.toLowerCase();
            const location = document.getElementById('locationFilter').value;
            const minScore = parseInt(document.getElementById('scoreFilter').value);
            const status = document.getElementById('statusFilter').value;

            return jobs.filter(job => {
                const matchesSearch = !search || 
                    job.titre.toLowerCase().includes(search) || 
                    job.entreprise.toLowerCase().includes(search) ||
                    job.stack.toLowerCase().includes(search);
                const matchesLocation = !location || job.localisation.includes(location);
                const matchesScore = job.score >= minScore;
                const matchesStatus = !status || getJobStatus(job.id) === status;

                return matchesSearch && matchesLocation && matchesScore && matchesStatus;
            });
        }

        // Render jobs
        function renderJobs() {
            const grid = document.getElementById('jobsGrid');
            const emptyState = document.getElementById('emptyState');
            const filteredJobs = getFilteredJobs();

            if (filteredJobs.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
                grid.innerHTML = filteredJobs.map(renderJobCard).join('');

                // Add click listeners
                document.querySelectorAll('.job-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const jobId = card.dataset.jobId;
                        openModal(jobId);
                    });
                });
            }
        }

        // Populate location filter
        function populateLocationFilter() {
            const locations = [...new Set(jobs.map(job => {
                // Extract city name
                const parts = job.localisation.split(',');
                return parts[0].trim();
            }))];

            const select = document.getElementById('locationFilter');
            locations.forEach(loc => {
                const option = document.createElement('option');
                option.value = loc;
                option.textContent = loc;
                select.appendChild(option);
            });
        }

        // Update stats
        function updateStats() {
            document.getElementById('totalJobs').textContent = jobs.length;
            
            const appliedCount = jobs.filter(job => 
                ['applied', 'interview', 'accepted'].includes(getJobStatus(job.id))
            ).length;
            document.getElementById('appliedJobs').textContent = appliedCount;

            const avgScore = jobs.length > 0 
                ? (jobs.reduce((sum, job) => sum + job.score, 0) / jobs.length).toFixed(1)
                : 0;
            document.getElementById('avgScore').textContent = avgScore;
        }

        // Open modal
        function openModal(jobId) {
            const job = jobs.find(j => j.id === jobId);
            if (!job) return;

            document.getElementById('modalTitle').textContent = job.titre;
            document.getElementById('modalCompany').innerHTML = `üè¢ ${job.entreprise}`;
            document.getElementById('modalLocation').innerHTML = `üìç ${job.localisation}`;
            document.getElementById('modalContract').textContent = job.type_contrat;
            document.getElementById('modalExperience').textContent = job.experience_requise;
            document.getElementById('modalSalary').textContent = job.salaire;
            document.getElementById('modalStack').textContent = job.stack;
            document.getElementById('modalComment').textContent = job.commentaire;
            document.getElementById('modalApplyBtn').href = job.lien;
            document.getElementById('modalCompanyBtn').href = job.entreprise_url;

            // Positives
            const positivesHtml = job.points_positifs.map(p => 
                `<div class="point-positive">‚úì ${p}</div>`
            ).join('');
            document.getElementById('modalPositives').innerHTML = positivesHtml || '<p style="color: #64748b;">Aucun</p>';

            // Negatives
            const negativesHtml = job.points_negatifs.map(p => 
                `<div class="point-negative">‚úó ${p}</div>`
            ).join('');
            document.getElementById('modalNegatives').innerHTML = negativesHtml || '<p style="color: #64748b;">Aucun</p>';

            // Status buttons
            const currentStatus = getJobStatus(jobId);
            document.querySelectorAll('.status-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.status === currentStatus);
                btn.onclick = () => {
                    setJobStatus(jobId, btn.dataset.status);
                    document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                };
            });

            document.getElementById('modalOverlay').classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        // Initialize
        async function init() {
            loadStatuses();

            // Try to load from jobs.json, fallback to test data
            try {
                const response = await fetch('jobs.json');
                if (response.ok) {
                    jobs = await response.json();
                } else {
                    jobs = testJobs;
                }
            } catch (e) {
                jobs = testJobs;
            }

            // Ensure all jobs have an id
            jobs = jobs.map((job, index) => ({
                ...job,
                id: job.id || String(index + 1)
            }));

            populateLocationFilter();
            renderJobs();
            updateStats();

            // Filter listeners
            document.getElementById('searchFilter').addEventListener('input', renderJobs);
            document.getElementById('locationFilter').addEventListener('change', renderJobs);
            document.getElementById('scoreFilter').addEventListener('change', renderJobs);
            document.getElementById('statusFilter').addEventListener('change', renderJobs);

            // Modal listeners
            document.getElementById('modalClose').addEventListener('click', closeModal);
            document.getElementById('modalOverlay').addEventListener('click', (e) => {
                if (e.target === document.getElementById('modalOverlay')) {
                    closeModal();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') closeModal();
            });
        }

        init();
    </script>
</body>
</html>
